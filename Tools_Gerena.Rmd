---
title: "DE6200 Notebook"
author: "Kevin Gerena"
output:
  html_document:
    df_print: paged
---

<mark> See above: I have added author to your YAML header.

<mark> Also, Heading 3 (###) for dates.

### 23 Aug 2023

```{r}
#Data: number of ticks found on dogs sampled from a shelter
tickdata<-c(0,0,0,0,1,0,6,0,3,3,5,22,0,0,3,33,4,2,1,23,7,2,4,6,78)
hist(tickdata, breaks=90)
```

<mark> Upload your 'Images' folder to the Github.

![Epidemiological Triad](Images/EpiTriad.png)

# Markdown Basics
## Heading 2
### *Heading 3*
#### **Heading 4**
*Italics*
**Bold**
***Bold and Italics***
Summary: I learned about formatting and notation within R-Notebook. I had never previously used this tool.

<mark> Spacing is very important when you use RMarkdown. For example, add space (enter) before 'Summary:...' above.

### 8-30-23 Measures of Disease Frequency
![Sample Size Table by Roe and Cannon (1982)](Images/ss_table.png)

<mark> Spacing between the two lines above.
<mark> Use a consistent heading style. For 'Questions' below use ####. Also, remember to use spaces between a header and the following paragraph.

# Questions
1. 59 Deer
2. 95% confidence at 1% prevalence required 70 more deer than 99% confidence at 2% prevalence.
3. <1% prevalence
4. 
Lee County: 20% prevalence (+/-13%)
Chambers County: 26.7% prevalence (+/-31.8%)
Russell County: 3.1% prevalence (+/-7.8%)

**Comparison of prevalences by Fisher's exact test**

                                  N  Infected Non-inf.   Prev.%
Chambers.Turkey$lameness          30       8      22      26.7 
Lee.Turkey$lameness              150      30     120      20.0 
Russell.Turkey$lameness           96       3      93       3.1 

     Two-sided p-value: <0.0001 
This p-value is significant, suggesting that prevalence of lameness in these three counties is significantly different. It should be noted that Chambers County has a large confidence interval that is likely a result of the small sample size potentially biasing results. Further tests are needed to evaluate this.

<mark> the following two lab assignments are mixed up. Separate them for better readability.

# 9/13/23

# 9-20-23 Frogs
![SIR Model of Contagious Frog Bullying Disease](Images/CFBD.png)
## Curve of recovered individuals appears to be logarithmic and nearly the inverse of infected individuals. Not all members of this population become infected or recovered; about 20% remain susceptible once infected reaches 0. Only about 20% of the population was infected at its peak.

```{r}
library(deSolve)
## Create an SIR function
sir <- function(time, y, parameters) {   #time, state , parameters
  
  with(as.list(c(y, parameters)), {
    
    dS <- -beta * S * I
    dI <-  beta * S * I - gamma * I
    dR <-                 gamma * I
    dN <- dS + dI + dR
    
    return(list(c(dS, dI, dR, dN)))
  })
}

### Set parameters
## Proportion in each compartment: Susceptible 0.999999, Infected 0.000001, Recovered 0
#init       <- c(S = 1-1e-6, I = 1e-6, R = 0.0)
init <- c(S = 0.99, I = 0.01, R = 0, N = 1)
## beta: infection parameter; gamma: recovery parameter
#parameters <- c(beta = 1.4247, gamma = 0.14286)b=.0952381 g = 0.04761905
parameters <- c(beta = 0.1, gamma = 0.05) #edited to try out other parameter values
## Time frame
times      <- seq(0, 300, by = 1)

## Solve using ode (General Solver for Ordinary Differential Equations)
out <- ode(y = init, times = times, func = sir, parms = parameters)
## change to data frame
out <- as.data.frame(out)
## Delete time variable
out$time <- NULL
## Show data
head(out, 10)

## Plot
matplot(x = times, y = out, type = "l",
        xlab = "Time", ylab = "Proportion", main = "SIR Model",
        lwd = 1, lty = 1, bty = "l", col = 1:4)

## Add legend
legend(240, 0.7, c("Susceptible", "Infected", "Recovered", "Total"), pch = 1, col = 1:4, bty = "n")

##Contagious Frog Bullying Disease 9-20-23
library(deSolve)
## Create an SIR function
sir <- function(time, y, parameters) {   #time, state , parameters
  
  with(as.list(c(y, parameters)), {
    
    dS <- -beta * S * I
    dI <-  beta * S * I - gamma * I
    dR <-                 gamma * I
    dN <- dS + dI + dR
    
    return(list(c(dS, dI, dR, dN)))
  })
}

### Set parameters
## Proportion in each compartment: Susceptible 0.999999, Infected 0.000001, Recovered 0
#init       <- c(S = 1-1e-6, I = 1e-6, R = 0.0)
init <- c(S = 0.99, I = 0.01, R = 0, N = 1)
parameters <- c(beta = 0.0952, gamma = 0.0476) 
## Time frame
times      <- seq(0, 300, by = 1)

## Solve using ode (General Solver for Ordinary Differential Equations)
out <- ode(y = init, times = times, func = sir, parms = parameters)
## change to data frame
out <- as.data.frame(out)
## Delete time variable
out$time <- NULL
## Show data
head(out, 10)

## Plot
matplot(x = times, y = out, type = "l",
        xlab = "Time", ylab = "Proportion", main = "SIR Model",
        lwd = 1, lty = 1, bty = "l", col = 1:4)

## Add legend
legend(240, 0.7, c("Susceptible", "Infected", "Recovered", "Total"), pch = 1, col = 1:4, bty = "n")
```